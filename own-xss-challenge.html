<!DOCTYPE html><html><head><title>Alain's Blog | My first XSS challenge - Writeup</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><meta name="robots" content="index,follow"><meta name="theme-color" content="#212121"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><link rel="shortcut icon" href="/coding-blog-boilerplate/favicon.ico"><link href="https://fonts.googleapis.com/css?family=Hind:400,700&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:300,400&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/icon?family=Material+Icons%7CMaterial+Icons+Outlined&amp;display=swap" rel="stylesheet"><style>
      body, input, button {
        font-family: 'Hind', sans-serif;
      }

      code, .hljs {
        font-family: 'Source Code Pro', 'Courier New', Courier, monospace;
      }

      .icon-font {
        font-family: 'Material Icons';
        font-weight: normal;
        font-style: normal;
        font-size: 24px;  /* Preferred icon size */
        display: inline-block;
        line-height: 1;
        text-transform: none;
        letter-spacing: normal;
        word-wrap: normal;
        white-space: nowrap;
        direction: ltr;
      
        /* Support for all WebKit browsers. */
        -webkit-font-smoothing: antialiased;
        /* Support for Safari and Chrome. */
        text-rendering: optimizeLegibility;
      
        /* Support for Firefox. */
        -moz-osx-font-smoothing: grayscale;
      
        /* Support for IE. */
        font-feature-settings: 'liga';
      }

      .icon-font.outline {
        font-family: 'Material Icons Outlined';
      }
    </style><link href="/coding-blog-boilerplate/styles/codedoc-styles.css" rel="stylesheet"><script async="" defer="" src="/coding-blog-boilerplate/bundle/codedoc-bundle.js"></script><script>window.githubConfig={"repo":"blog","user":"krial057"}</script><style>.container{padding-top: 0 !important}</style><style>#-codedoc-toc { backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px) }</style><meta name="twitter:title" content="Alain's Blog | My first XSS challenge - Writeup"><meta property="og:type" content="article"><meta property="og:title" content="Alain's Blog | My first XSS challenge - Writeup"><meta property="og:image" content="https://images.unsplash.com/photo-1486312338219-ce68d2c6f44d?w=1900&amp;h=600&amp;fit=crop"><meta name="keywords" content=""><meta property="blog-tags" content=""></head><body><div class="header-0-0-3"></div><div id="-codedoc-container" class="container"><script>window.source = {"base":"posts","path":"own-xss-challenge.md","namespace":"/coding-blog-boilerplate","title":{"base":"Alain's Blog","connector":" | "}}</script><div class="hero-0-0-12" data-mode="light" data-target="desktop" style="margin-bottom: -156px"><picture><source media="(min-width: 1025px)" srcset="https://images.unsplash.com/photo-1486312338219-ce68d2c6f44d?w=1900&amp;h=600&amp;fit=crop"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=" class="image-0-0-13" data-src="https://images.unsplash.com/photo-1486312338219-ce68d2c6f44d?w=1900&amp;h=600&amp;fit=crop" data-hero=""></picture><span class="caption-0-0-14"></span></div><div class="hero-0-0-12" data-mode="light" data-target="mobile" style="margin-bottom: -96px"><picture><source media="(max-width: 1024px)" srcset="https://images.unsplash.com/photo-1486312338219-ce68d2c6f44d?w=1200&amp;h=600&amp;fit=crop"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=" class="image-0-0-13" data-src="https://images.unsplash.com/photo-1486312338219-ce68d2c6f44d?w=1200&amp;h=600&amp;fit=crop" data-hero=""></picture><span class="caption-0-0-14"></span></div><div class="hero-0-0-12" data-mode="dark" data-target="desktop" style="margin-bottom: -156px"><picture><source media="(min-width: 1025px)" srcset="https://images.unsplash.com/photo-1508780709619-79562169bc64?w=1900&amp;h=600&amp;fit=crop"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=" class="image-0-0-13" data-src="https://images.unsplash.com/photo-1508780709619-79562169bc64?w=1900&amp;h=600&amp;fit=crop" data-hero=""></picture><span class="caption-0-0-14"></span></div><div class="hero-0-0-12" data-mode="dark" data-target="mobile" style="margin-bottom: -96px"><picture><source media="(max-width: 1024px)" srcset="https://images.unsplash.com/photo-1508780709619-79562169bc64?w=1200&amp;h=600&amp;fit=crop"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=" class="image-0-0-13" data-src="https://images.unsplash.com/photo-1508780709619-79562169bc64?w=1200&amp;h=600&amp;fit=crop" data-hero=""></picture><span class="caption-0-0-14"></span></div><h1 class="h-0-0-9 white"><span style=" 
      text-shadow: 0 0 8px black; 
      font-size: 48px"><p>My first XSS challenge - Writeup</p></span></h1><script id="oQsykWcqSr">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("oQsykWcqSr", "tvU4ZvTyVzKC9UotaYeV1w==", {"src":"github"});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script><marker><br>

</marker><p>So this is the content of this sample blog post. For a new blogpost, just copy the contents of <br><code>posts/sample-blog-post.md</code> and get started quickly!</p><hr><pre class="with-bar"><code class="php -codedoc-code-snippet code-0-0-15" tabindex="0"><span class="wmbar-0-0-18"><span></span><span></span><span></span><span>index.php</span></span><div class="line-0-0-17  -codedoc-code-line" data-content="<?php " id="code1-l1"><span class="lineCounter-0-0-16 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> </span></div><br><div class="line-0-0-17  -codedoc-code-line" data-content="  $nonce = base64_encode(random_bytes(32));" id="code1-l2"><span class="lineCounter-0-0-16 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>  <span class="token variable">$nonce</span> <span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">random_bytes</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-17  -codedoc-code-line" data-content="  header(&quot;Content-Security-Policy: default-src 'none'; script-src 'nonce-&quot;.$nonce.&quot;'&quot;); // --> Only allow script execution with the right nonce token" id="code1-l3"><span class="lineCounter-0-0-16 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>  <span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Content-Security-Policy: default-src 'none'; script-src 'nonce-"</span><span class="token punctuation">.</span><span class="token variable">$nonce</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// --&gt; Only allow script execution with the right nonce token</span></div><br><div class="line-0-0-17  -codedoc-code-line" data-content="?>" id="code1-l4"><span class="lineCounter-0-0-16 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token delimiter important">?&gt;</span></div><br><div class="line-0-0-17  -codedoc-code-line" data-content="<html>" id="code1-l5"><span class="lineCounter-0-0-16 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span></div><br><div class="line-0-0-17  -codedoc-code-line" data-content="    <body>" id="code1-l6"><span class="lineCounter-0-0-16 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span></div><br><div class="line-0-0-17  -codedoc-code-line" data-content="        <?php" id="code1-l7"><span class="lineCounter-0-0-16 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></div><br><div class="line-0-0-17  -codedoc-code-line" data-content="            $todos = '';" id="code1-l8"><span class="lineCounter-0-0-16 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span class="token variable">$todos</span> <span class="token operator">=</span> <span class="token single-quoted-string string">''</span><span class="token punctuation">;</span></div><br><div class="line-0-0-17  -codedoc-code-line" data-content="            $todos = $todos.&quot;<div> Todo #1 </div>\n&quot;; // --> A constant TODO" id="code1-l9"><span class="lineCounter-0-0-16 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span class="token variable">$todos</span> <span class="token operator">=</span> <span class="token variable">$todos</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"&lt;div&gt; Todo #1 &lt;/div&gt;\n"</span><span class="token punctuation">;</span> <span class="token comment">// --&gt; A constant TODO</span></div><br><div class="line-0-0-17  -codedoc-code-line" data-content="            $todos = $todos.&quot;<div> Todo #2 </div>\n&quot;; // --> A constant TODO" id="code1-l10"><span class="lineCounter-0-0-16 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span class="token variable">$todos</span> <span class="token operator">=</span> <span class="token variable">$todos</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"&lt;div&gt; Todo #2 &lt;/div&gt;\n"</span><span class="token punctuation">;</span> <span class="token comment">// --&gt; A constant TODO</span></div><br><div class="line-0-0-17  -codedoc-code-line" data-content="            $todos = $todos.&quot;<div> &quot;.$_GET['todo'].&quot; </div>\n&quot;; // --> A TODO supplied by the user over url" id="code1-l11"><span class="lineCounter-0-0-16 -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span class="token variable">$todos</span> <span class="token operator">=</span> <span class="token variable">$todos</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"&lt;div&gt; "</span><span class="token punctuation">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'todo'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token double-quoted-string string">" &lt;/div&gt;\n"</span><span class="token punctuation">;</span> <span class="token comment">// --&gt; A TODO supplied by the user over url</span></div><br><div class="line-0-0-17  -codedoc-code-line" data-content="            $todo_list = explode(&quot;\n&quot;, $todos);" id="code1-l12"><span class="lineCounter-0-0-16 -codedoc-line-counter">12<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span class="token variable">$todo_list</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"\n"</span><span class="token punctuation">,</span> <span class="token variable">$todos</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-17  -codedoc-code-line" data-content="            foreach($todo_list as $todo) {" id="code1-l13"><span class="lineCounter-0-0-16 -codedoc-line-counter">13<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$todo_list</span> <span class="token keyword">as</span> <span class="token variable">$todo</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-17  -codedoc-code-line" data-content="                if(strpos($todo, &quot;script&quot;) === false) { // --> Don't allow script injections in todos" id="code1-l14"><span class="lineCounter-0-0-16 -codedoc-line-counter">14<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$todo</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"script"</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token boolean constant">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// --&gt; Don't allow script injections in todos</span></div><br><div class="line-0-0-17  -codedoc-code-line" data-content="                    echo $todo.&quot;\n&quot;;" id="code1-l15"><span class="lineCounter-0-0-16 prim -codedoc-line-counter">15<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>                    <span class="token keyword">echo</span> <span class="token variable">$todo</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"\n"</span><span class="token punctuation">;</span></div><br><div class="line-0-0-17  -codedoc-code-line" data-content="                } " id="code1-l16"><span class="lineCounter-0-0-16 -codedoc-line-counter">16<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>                <span class="token punctuation">}</span> </div><br><div class="line-0-0-17  -codedoc-code-line" data-content="            }" id="code1-l17"><span class="lineCounter-0-0-16 -codedoc-line-counter">17<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span class="token punctuation">}</span></div><br><div class="line-0-0-17  -codedoc-code-line" data-content="        ?>" id="code1-l18"><span class="lineCounter-0-0-16 -codedoc-line-counter">18<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token delimiter important">?&gt;</span></div><br><div class="line-0-0-17  -codedoc-code-line" data-content="" id="code1-l19"><span class="lineCounter-0-0-16 -codedoc-line-counter">19<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-17  -codedoc-code-line" data-content="        <script nonce=&quot;<?php echo $nonce ?>&quot;>" id="code1-l20"><span class="lineCounter-0-0-16 prim -codedoc-line-counter">20<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">nonce</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token variable">$nonce</span> <span class="token delimiter important">?&gt;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"></span></span></div><br><div class="line-0-0-17  -codedoc-code-line" data-content="            window.onload = () => {" id="code1-l21"><span class="lineCounter-0-0-16 -codedoc-line-counter">21<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-17  -codedoc-code-line" data-content="                console.log(&quot;bla&quot;)" id="code1-l22"><span class="lineCounter-0-0-16 -codedoc-line-counter">22<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"bla"</span><span class="token punctuation">)</span></div><br><div class="line-0-0-17  -codedoc-code-line" data-content="            }" id="code1-l23"><span class="lineCounter-0-0-16 -codedoc-line-counter">23<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span class="token punctuation">}</span></div><br><div class="line-0-0-17  -codedoc-code-line" data-content="        </script>" id="code1-l24"><span class="lineCounter-0-0-16 -codedoc-line-counter">24<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></div><br><div class="line-0-0-17  -codedoc-code-line" data-content="    </body>" id="code1-l25"><span class="lineCounter-0-0-16 prim -codedoc-line-counter">25<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span></div><br><div class="line-0-0-17  -codedoc-code-line" data-content="</html>" id="code1-l26"><span class="lineCounter-0-0-16 prim -codedoc-line-counter">26<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></div><br></code></pre><div class="darklight-0-0-1"><div class="dark"><p><em>Hero image by <a href="https://unsplash.com/@kaitlynbaker">Kaitlyn Baker</a> from <a href="https://unsplash.com">Unsplash</a></em></p></div><div class="light"><p><em>Hero image by <a href="https://unsplash.com/@glenncarstenspeters">Glenn Carstens-Peters</a> from <a href="https://unsplash.com">Unsplash</a></em></p></div></div><div class="contentnav-0-0-8" data-no-search=""></div></div><div id="-codedoc-toc" class="toc-0-0-5"><script>
     if (window.matchMedia('(min-width: 1200px)').matches) {
       if (!localStorage.getItem('-codedoc-toc-active')) {
         localStorage.setItem('-codedoc-toc-active', "true");
       }
     }
     </script><div class="content-0-0-6"><p><a href="/coding-blog-boilerplate/">Home</a>
<a href="/coding-blog-boilerplate/own-xss-challenge">Own XSS Challenge Writeup</a></p></div></div><div class="footer-0-0-4"><div class="left"><script id="aRuEFHsqdg">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("aRuEFHsqdg", "k0lYj9deiYXngpZFqYY0vQ==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script></div><div class="main"><div class="inside"></div></div><div class="right"><script id="hXbOmCHBmC">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("hXbOmCHBmC", "QtGDrozMmpfzLYU0jY3n+w==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script></div></div><script id="PzgbYHcRlN">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("PzgbYHcRlN", "Rs0VnrLCFSwfOm1o3R6OHg==", {"namespace":"/coding-blog-boilerplate"});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script></body></html>